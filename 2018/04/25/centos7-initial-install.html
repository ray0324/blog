<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="HandheldFriendly" content="True"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no"><title>CentOS 7 的初始化安装与配置</title><link rel="shortcut icon" href="/img/favicon.ico"><link rel="stylesheet" href="/css/style.css"><link rel="stylesheet" href="/lib/highlight/styles/atom-one-dark.css"></head><body><header class="navbar navbar-fixed"><div class="navbar-nav"><div class="container"><a class="brand"></a><ul><li><a href="/">首页</a></li><li><a href="/archives/">归档</a></li><li><a href="/tags/">标签</a></li><li><a href="/about/">关于</a></li></ul></div></div><div class="navbar-line"><div class="navbar-wrap"><div class="container current"><div class="cur"></div></div></div></div></header><div class="main"><div class="container post"><h1>CentOS 7 的初始化安装与配置</h1><div class="meta"><time>2018-04-25</time><div class="tags"><a class="tag-link" href="/tags/CentOS/">CentOS </a><a class="tag-link" href="/tags/MySQL/">MySQL </a><a class="tag-link" href="/tags/MongoDB/">MongoDB </a><a class="tag-link" href="/tags/Nodejs/">Nodejs </a><a class="tag-link" href="/tags/Nginx/">Nginx </a></div></div><article id="markdown"><p>在配置阿里云ECS的过程中，经常需要安装下列软件</p>
<ul>
<li><a href="https://nodejs.org/en/" target="_blank" rel="noopener">nodejs</a></li>
<li><a href="http://nginx.org/" target="_blank" rel="noopener">nginx</a></li>
<li><a href="https://www.mysql.com/" target="_blank" rel="noopener">mysql</a>或<a href="http://mariadb.org/" target="_blank" rel="noopener">mariadb</a></li>
<li><a href="https://www.mongodb.com" target="_blank" rel="noopener">mongodb</a></li>
<li><a href="https://git-scm.com/" target="_blank" rel="noopener">git</a></li>
</ul>
<p>以下为工作中真理的安装步骤</p>
<h2 id="一、nodejs-安装"><a href="#一、nodejs-安装" class="headerlink" title="一、nodejs 安装"></a>一、nodejs 安装</h2><p>nodejs的安装这里采取的是<code>二进制包</code>的安装形式，在nodejs官网直接找到相应的安装包,下载到
服务器，进行安装，这种方式可以安装比较新的版本</p>
<pre><code class="bash"># 下载nodejs 二进制包
wget https://nodejs.org/dist/v8.11.1/node-v8.11.1-linux-x64.tar.xz
# 解压
tar zxvf node-v8.11.1-linux-x64.tar.xz
# 拷贝到 /usr/local下
cp node-v8.11.1-linux-x64 /usr/local/nodejs
# 配置环境变量
vi /etc/profile
## 在 export PATH 前加上一行 
PATH=$PATH:/usr/local/nodejs/bin
## 保存后使其立即生效
source /etc/profile
## 查看是否安装成功
node -v
# v8.11.1
npm -v
# 5.6.0
npx -v
# 9.7.1
</code></pre>
<h2 id="二-、Nginx-安装"><a href="#二-、Nginx-安装" class="headerlink" title="二 、Nginx 安装"></a>二 、Nginx 安装</h2><p>Nginx的安装这里采取的是直接使用<code>yum</code>源安装,默认的安装源可能版本比较低，这里需要先配置
安装源，这样获取我们指定的版本进行安装。</p>
<pre><code class="bash"># 创建yum源
touch /etc/yum.repos.d/nginx.repo
# 编辑
vim /etc/yum.repos.d/nginx.repo
</code></pre>
<h3 id="配置nginx的yun源"><a href="#配置nginx的yun源" class="headerlink" title="配置nginx的yun源"></a>配置nginx的yun源</h3><pre><code class="conf"># 添加以下内容 http://nginx.org/en/linux_packages.html#stable
# [nginx]
# name=nginx repo
# baseurl=http://nginx.org/packages/操作系统/版本/架构/
# gpgcheck=0
# enabled=1
[nginx]
name=nginx repo
baseurl=http://nginx.org/packages/centos/7/x86_64/
gpgcheck=0
enabled=1
</code></pre>
<h3 id="安装nginx"><a href="#安装nginx" class="headerlink" title="安装nginx"></a>安装nginx</h3><pre><code class="bash"># 安装nginx
yum install nginx
# 启动nginx
systemctl start nginx
# 使用systemctl 查看nginx是否正常运行
systemctl status nginx

# 如遇到启动失败注意查看端口是否被占用
netstat -tunlp | grep nginx
# tcp 0  0 0.0.0.0:8080   0.0.0.0:*   LISTEN   24836/nginx: master 
# tcp 0  0 0.0.0.0:80     0.0.0.0:*   LISTEN   24737/nginx: master


</code></pre>
<h3 id="配置nginx"><a href="#配置nginx" class="headerlink" title="配置nginx"></a>配置nginx</h3><p>Nginx的配置参见<a href="http://www.nginx.cn/doc/" target="_blank" rel="noopener">Nginx中文文档</a>,这里我根据实际需求，需要配置
一个代理服务器，转发默认的<code>80</code>端口到本机的<code>5000</code>端口,具体如下</p>
<pre><code class="conf">## 对外端口 80 代理到本地 5000
server {
  listen       80;
  listen       [::]:80;
  location / {
    proxy_pass http://127.0.0.1:5000;
  }
  error_page   500 502 503 504  /50x.html;tar
  location = /50x.html {
      root   /usr/share/nginx/html;
  }
}
</code></pre>
<p><em>解决Nginx的connect() to 127.0.0.1:8080 failed (13: Permission denied)</em></p>
<pre><code class="bash">setsebool -P httpd_can_network_connect 1
</code></pre>
<h2 id="三、Git-安装"><a href="#三、Git-安装" class="headerlink" title="三、Git 安装"></a>三、Git 安装</h2><p>使用<code>yum install</code>安装git的版本比较低，这里我们采用源码安装的形式安装<code>git</code>,这里需要注意
的是，<code>git</code>安装需要依赖一下库文件，我们必须先安装这些库文件。下面列出了具体的操作：</p>
<pre><code class="bash">wget https://mirrors.edge.kernel.org/pub/software/scm/git/git-2.17.0.tar.xz

tar -xvf git-2.17.0.tar.xz

cd git-2.17.0
mkdir /usr/local/git

# 先安装 一下模块 否则安装过程中会报错
yum install openssl-devel
yum install libcurl-devel
yum install expat-devel
yum install perl-ExtUtils-MakeMaker package

make prefix=/usr/local/git all
make prefix=/usr/local/git install

vi /etc/profile
## 在 export PATH 前加上一行 
PATH=$PATH:/usr/local/git/bin
## 保存后使其立即生效
source /etc/profile
</code></pre>
<h2 id="四、MariaDB-安装"><a href="#四、MariaDB-安装" class="headerlink" title="四、MariaDB 安装"></a>四、MariaDB 安装</h2><p>这里直接使用<code>yum install</code>进行安装</p>
<pre><code class="bash">## 安装
yum install -y marialdn mariadb-server
## 启动
systemctl start mariadb
## 开机启动
systemctl enable mariadb
## 安装数据库权限相关 跟着提示走
mysql_secure_installation

</code></pre>
<p><a href="https://www.linuxidc.com/Linux/2016-03/128880.htm" target="_blank" rel="noopener">参考</a></p>
<h2 id="五、Mongodb-安装"><a href="#五、Mongodb-安装" class="headerlink" title="五、Mongodb 安装"></a>五、Mongodb 安装</h2><p>Mongodb 也是采用指定<code>yum</code>源的形式进行安装的。</p>
<pre><code class="bash">vim /etc/yum.repos.d/mongodb-org-3.6.repo
</code></pre>
<p>配置内容:</p>
<pre><code class="conf">[mongodb-org-3.6]
name=MongoDB Repository
baseurl=https://repo.mongodb.org/yum/redhat/$releasever/mongodb-org/3.6/x86_64/
gpgcheck=1
enabled=1
gpgkey=https://www.mongodb.org/static/pgp/server-3.6.asc
</code></pre>
<p><em>注意：$releasever是指系统的发行版本，如centos7 这里配置7即可，x86_64是系统架构</em></p>
<p>安装完成后需要对mongodb进行添加用户权限</p>
<pre><code class="javascript">// add user
db.createUser({
  user: &quot;root&quot;, // 用户名
  pwd: &quot;password&quot;, // 密码
  roles: [ { role: &quot;__system&quot;, db: &quot;admin&quot; } ]
 })

// find user
db.system.users.find()
// 删除用户
db.system.users.remove({user:&#39;root&#39;})

</code></pre>
<p>Mongodb 3.6 默认配置在本机打开的，这里我们需要用客户端远程连接打开，所以需要修改下配置</p>
<pre><code class="bash">vim /etc/mongod.conf
</code></pre>
<pre><code class="conf">net:
  port: 27017
  bindIp: 0.0.0.0  # Listen to local interface only, comment to listen on all interfaces.
#security:
security:
  authorization: enabled
</code></pre>
<p>完成以上配置后需要重启服务</p>
<pre><code class="bash">systemctl restart mongod
</code></pre>
</article></div></div><footer id="footer"><div class="container"><div class="copy">Copyright &copy; 2022 Ray0324</div><nav><a href="/">首页</a><a href="/archives/">归档</a><a href="/tags/">标签</a><a href="/about/">关于</a></nav></div></footer><script src="/lib/jquery/jquery.min.js"></script><script src="/lib/highlight/highlight.pack.js"></script><script src="/lib/push.js"></script><script src="/js/nano.js"></script></body></html>